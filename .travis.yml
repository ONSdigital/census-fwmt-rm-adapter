language: java
jdk: oraclejdk8
services:
- docker
before_install:
- docker run  -d --name rabbit -p 5672:5672 rabbitmq:3.6
install: true
script:
- "if [[ $TRAVIS_COMMIT_MESSAGE != 'JENKINS SNAPSHOT UPDATE' ]];
  then ./gradlew build --info;
  fi"
env:
  global:
  - SPRING_PROFILES_ACTIVE=default,integration-tests
  - secure: 2ETaCwdvLb+5uHPU/YwTPZrdpBJ0mgLcNOk0omwjrYVQ4w3axaR2m1ZkIQ6chlhXViAeeUHdT8n5yuYF0RqGShRARyXR4r4ywMTMBXrEdu1fPSzoncpiw/1WwDkr4yGhTony/qjrHrFgFiftQ9gk7JmI/Tyj+yAH5jz92mzESGC/9lmsub5JP6Oi4PlBPWV9JVFbX/oZlrgyULaxjREl9LM5TMU2Rp8Zj99dPy9GsL8skdsNpivM3PK+94jHi/P6Sgxn2M1O2fFQMdMicW8jlO9mNSqZJVyUNNjpwUCH/dTquYpSCmfNkUXQUrPbcX0zzYHVdA2rAouaUtY10HexEFCI0i2ng+ANlbssjVmAUhj4/HNAXrgEcCLAcP3xqDMWUbRTYUZ+uTmPE9qoEg+i3Jc7OCptXlhzWbouoPa5goVEJifU+d0NUO+67LtpsxD138bQRyCjZpZqpEnITw+0WFtRwRPcoLXwZ6AA8laA994pQG1Zau0CXhwuoXJV0F1t6NGBzVhneSFNbeKfKWlBiecaSkogqmk1JBpoFoTsgYRwqhhmGYc5t17TWob3bFp/0COMrbA58Q0xlrttQSTwuZcJZIs16Pj7x9w7XU12fv9zdnOYAWJLE5Ig5LaFzFVrzCmB86A1L+jblec34xjt0TLu33uXipHOAw5YUlLoezI=
  - secure: rmCqlgfp0lJI1igT3jesc2dcNpdlm0P5KAaHDmK3wrsuXFHHs4YfHaJmuPiB1TMLxHsiUtn3K4cGWCCoaQLyAoqFoNh7zrrmYngNB8wFwLgwpRbjtGu2hLumL20Lz4HiaZvBXgpwmu95BCKXv66Ffva27Uq+GnMhy4l8o+8h3zdy09Cl5nE+2cBh4oIFB2yIj7u/OVUcFsALVDiQ5ELZTEHFcl8H7q88RHYbGlkDbcXDdmy0jWQ59qeWWwSwk3/ZhQ+c6s0fLEZnFnZ6S6itIDCzaOJm0ck5d2h9XRKivoVPF0gppGl2IATtZ74m0+BjUeWXNuu7uneLIIxrhvqLGcVNw/7rzvOEtucF27nCARxtBMysoqiJpnmbsqzOWNunY2uynBO82/YumNehNhn+yh3KaIpbEV7cBXQ2AwjVQZfT7eTT50sGxegygIlHTtfftJ8oi5fACatM3ejRGCSygfmajK+b+secUZnlknSKh5igpvVQgIBsf6BCpJ2AHEYEwNW/lFx3ubmFdupzCn9r3z8f66oKd5kV2Hj8M9BFF8f1qd+1+H5oH+hE36IAjHE7DTZG49qjoiwBtrL4PmlKBkbpqxReW9dTb7S9w6oE+81KTeuxXkh4tQzoLu1w7/2OrbcZk8LF77ZehSHKyXMDd2vYcISU8sAbSO3QMeiyw/0=
  - secure: LqllncTgvbmf9mSKaeXJHIJqawAyqu3oIaVrnG7QoFJQ3fuYLuM/jLjp2SLmnSR3eVHV67qAcRXqMTmg3P1YTQG7RigqXsGevR5sEi5lki2+g2h3bkj+9Ngquxk8LlHkdKSGfosW9dcRv0cfQ4cMRI5OjyJWOIZsdGRG8Mu6ZsgDyL3QCuci8FeT8fo9Q/TSS4GgPTTQa4srbnVMfVidU6k2f9WNFWD92ttTeGeO6km5ajhMbCiYIMlXt0TSJqRtzPDGC2k+9KQR95S9SnUwxRMAZuu+iE3Dj4J3Lyu66JQyPzrHKduFtYTXimMTFt8kpxzo59m8qoz3Z2Hxxgpxh1jFrN2eoww0grRK7fRZOZLC4Pvopt3CcB/Hk8n4mw88H1RHiZM6mSqfEE/LHN/dz3a4KLH6cpO1oS0LS0sazsJK/ho2w0nfJ0Tf0utbpuaiM2sc9hfpWbSjOl/kU0C4QHqR2wVGJt6osdPBFuJH9couqzHhbKAJwZxPKWE0gA3KNbq47kSJzyU2SCnOMFbn5z1HFIqA2eoz04RCCJegdXEye+HkVN9Z2IXYusT/DOXwBBNrIk6Jc7vWSEtbG2jfgu8edA/P9ZExA4IcwCuAHqCsFevDMIYe7DvKCUUX3tvMr6kjOh2SHczhkq/g3zh2TPAWR7jePqUVOZ4GGV7/qUk=
  - secure: i+kTBzzva5MzVX/DuHSeKBy47M6v5H/O590+7BsudjyptiYRtdDs2un0GEpaS6sFn1xjYU+1epQjhkp5avbjToQBgehpc3Pjlj0PtgI6ToHowS837eG5pNKqM9BeX9ZrOJqwVxYgLYKfR+nVtbtNnmV9Ap+ywvOOKWQucEJUi7f52LWWK94DloAR+9DuWJ3ksg3lyBWTYeolLex47OH2tnTNp5iFwBbo/7j2re5e/Ak9X6Sq4oBVKNSS2AvcpcAS/9tUdfYZ2fEwKt4FVpJ/zZ3G4Voa8vsqckw1lYqJdGZMTnV89/UnwGgFwn3bDmkrf9JeA7HTcQKEcv66DFy9kpH28hfX7K0uWVoCdPPOfXcs56D0NnEizox+4IOrs42MzI3T7EV2wFmh8j8SHhCj/wNMKZb0fsG4feIjELPMOR//xm0eJ5Ig3ZpPJtL0u4+PPfC3ISRsFPkvXnzmrXqOSptNcnR47ViXQteSeUzFWgRMlSanwvftFzhGUy6EpKpto8VAub276Iu84CdOWL09dS2Kbp1flXiT4+PapsjdBTBfKlptzNbrFiqNUIr8dlFruA9DJqxtsusXwu19Ncpu5DcPrRg99XePOUCKHPxWSXs2ND37O22TVG6y2TQiIScuoieAa/OTxU3TaZCemUXSvkIvvpTm5nOwz7RVXTdzjoU=
  - secure: Il1XQQRmyyN+cPLH4XqZxQxAEH99sqBq0AEScwP1oWfW/Vo4N3Y0JovyGbq6/H4wL1ygVAJxdcz7vzP3TSSRFizvXjGdENgCM+dfHEoRXmhPurzyWdMvm79WLvczoRvBC+n0xhxOxXZAyPisvt/BIsrL8WQ1A8eh2Ww/JVhE0k3jIPopY3WP/KvyAYjbX7aHouzA1MNdO5/ay7G6Q3oXgURDs5ba5HhTNw80ooxJzZltHvFD5uCiIoAPIDbN56jmZeFHQhPMT0+R2EasQS3bYXnK2JEZnxaa/gbtnw2VAERedqCtkQ1HT5vgNAlxuOAuSyRqJjEuwwihrCN59jyEBW0si0jSAkvJIMOsV5Clj094UWDqBqt/ATwp7zRz0md864RbvSuHbWrA1TjjtDzXxtfMcXL4TzblC+NPzaCEJqFw//Qi0CFMapwF1bRyZs1XmQlSyMkxSA76CURbMTEOO/vQe9YQquwra2VfGAvS8HMC91xfyPO3dxZs9lBMpDp3y77ILmvuQ7Mf9Fovut3/ji9n1jmXiZyc0ijLPoK7yKYTjMZWJo1f5cEw965j2pWYHd9M4weTLJ8660A3+qQQikDCsA6D782UjVAsgkjC7a0wWWzSVaRi0YiJ4ZdQRdeRw1vp2UQ4QgUYa6GbWyiZWM/TGksWSlH1VEursvWNP+c=
branches:
  only:
  - master
notifications:
  slack:
    secure: B24srxRxVVx2NcqATpy82YYzL794ZTn4/xn8DprYEtLJlksYNK2aedoK2Xn5OkaFA9yEmxWkvE59jZnhMR6qeFKC7pihTvg1DlJyG9lkhUcWM3BjggUC1R1uDmrRx3l1jyihlpBeNGS6Q8bdUP9JZnVxY0IizK2x+jVBNgfIdpSVz5crgp5uvuwdoxTcpEqDDI+TQliNTjYTZCTOPR06WoBiimg1cXMVAE7kehfphQiOaxfAg5NVv7esuP9xckOOp8zY3Le+Z7NUy64VgogTetQVezxmFKaVtuY1wqnKqauLlohISeLyEhPDefjCXiT6o2V2c82Rahl6g/1D/NqrxurfqQmTTm8hVBVwSDc6frjvZR86IbNa8qGDL4VR8bZuQQtClsraj4Tw121cymEKlJD0MNXUgP77zttYt5RNEiqTP0sBsK579FhH84e7EK3MkWmhb2oQt8+jTqja9PPMZiGkE//ZYN/JxCGfoTOSdnewk3AcCKtf9azHHkkg6Iukew3HNvl+keBUiGBqgDAcYF/Zgrf18yiW1VsA+1tQSoJGpAze886Ld4d4efiiQhTohpwbnd5yK/Zk+d9k5zARbYTwWZyYSnkCmtFox73e1wT/Y9i2+2nBZuGK7dMEgkvf5Z6p7mb2215WiUke30GeT4bqpNPcurjF0AbWjmtbZMc=
after_success:
- if [[ "$TRAVIS_BRANCH" = "master" ]] && [[ "$TRAVIS_PULL_REQUEST" = "false" ]] && [[ $TRAVIS_COMMIT_MESSAGE != "JENKINS SNAPSHOT UPDATE" ]];
  then echo "$DOCKER_PASSWORD" | docker login --username "$DOCKER_USERNAME" --password-stdin;
  docker build -t fwmtrmadapter --build-arg jar=build/libs/fwmt-rm-adapter-*.jar .;
  docker tag fwmtrmadapter sdcplatform/fwmtrmadapter:rm-adapter-$TRAVIS_BUILD_NUMBER;
  docker push sdcplatform/fwmtrmadapter;
  ./gradlew artifactPublish;
  fi
